

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LISA single subject analysis using precoloring (vlisa_precoloring) &mdash; lipsia  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LISA single subject analysis using prewhitening (vlisa_prewhitening)" href="vlisa_prewhitening.html" />
    <link rel="prev" title="LISA twosample test (vlisa_twosample)" href="vlisa_twosample.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            lipsia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#lipsia-file-format">Lipsia file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#laminar-specific-fmri-analysis-cylarim-under-construction">Laminar-specific fMRI analysis (Cylarim) - under construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#statistical-inference-lisa-in-examples">Statistical inference (LISA) in examples:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#semi-blind-machine-learning-sml">Semi-blind machine learning (SML):</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#how-to-install-lipsia-using-singularity">How to install LIPSIA using Singularity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#install-lipsia-from-source-linux-unix-macos">Install LIPSIA from source (Linux/Unix/MacOS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#install-the-necessary-compilers-and-libraries">1) Install the necessary compilers and libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#ubuntu">Ubuntu:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#fedora">Fedora:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#macos">MacOS:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#clone-the-git-repository">2) Clone the git repository:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#execute-the-script-lipsia-setup-sh-in-a-shell">3) Execute the script “lipsia-setup.sh” (in a shell)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#compile-lipsia">4) Compile lipsia</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#change-bash-profile">5) Change bash profile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#install-lipsia-using-docker">Install LIPSIA using Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#install-docker-on-your-local-machine">1) Install docker on your local machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#build-the-dockerfile">3) Build the Dockerfile</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Laminar-specific fMRI (Cylarim)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/index.html">Cylarim overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#initial-steps">Initial steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#the-main-steps">The main steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#example-workflow">Example workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#contents">Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim.html">vcylarim</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim.html#parameters-of-vcylarim">Parameters of ‘vcylarim’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim_stats.html">vcylarim_stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_stats.html#examples">Examples:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_stats.html#parameters-of-vcylarim-stats">Parameters of ‘vcylarim_stats’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim_getmask.html">vcylarim_getmask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#parameters-of-vcylarim-getmask">Parameters of ‘vcylarim_getmask’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim_plot.html">vcylarim_plot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example-output">Example output:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_plot.html#parameters-of-vcylarim-plot">Parameters of ‘vcylarim_plot’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vrim.html">vrim</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vrim.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vrim.html#parameters-of-vrim">Parameters of ‘vrim’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vmetric.html">vmetric</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vmetric.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vmetric.html#parameters-of-vmetric">Parameters of ‘vmetric’</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim.html">vcylarim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim.html#parameters-of-vcylarim">Parameters of ‘vcylarim’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim_stats.html">vcylarim_stats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_stats.html#examples">Examples:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_stats.html#parameters-of-vcylarim-stats">Parameters of ‘vcylarim_stats’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim_plot.html">vcylarim_plot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example-output">Example output:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_plot.html#parameters-of-vcylarim-plot">Parameters of ‘vcylarim_plot’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim_getmask.html">vcylarim_getmask</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#parameters-of-vcylarim-getmask">Parameters of ‘vcylarim_getmask’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vmetric.html">vmetric</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vmetric.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vmetric.html#parameters-of-vmetric">Parameters of ‘vmetric’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vrim.html">vrim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vrim.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vrim.html#parameters-of-vrim">Parameters of ‘vrim’</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LISA statistical inference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="vlisa_generic.html">LISA generic framework (vlisa_generic)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_generic.html#parameters-of-vlisa-generic">Parameters of ‘vlisa_generic’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_generic.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_2ndlevel.html">LISA second-level GLM (vlisa_2ndlevel)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_2ndlevel.html#parameters-of-vlisa-2ndlevel">Parameters of ‘vlisa_2ndlevel’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_2ndlevel.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_onesample.html">LISA onesample test (vlisa_onesample)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_onesample.html#parameters-of-vlisa-onesample">Parameters of ‘vlisa_onesample’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_onesample.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_twosample.html">LISA twosample test (vlisa_twosample)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_twosample.html#parameters-of-vlisa-twosample">Parameters of ‘vlisa_twosample’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_twosample.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">LISA single subject analysis using precoloring (vlisa_precoloring)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parameters-of-vlisa-precoloring">Parameters of ‘vlisa_precoloring’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_prewhitening.html">LISA single subject analysis using prewhitening (vlisa_prewhitening)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_prewhitening.html#parameters-of-vlisa-prewhitening">Parameters of ‘vlisa_prewhitening’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_prewhitening.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Semi-blind machine learning (SML):</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sml/vsml.html">Semi-blind machine learning - ensemble learning (SML-EL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml.html#parameters-of-vsml">Parameters of ‘vsml’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sml/vsml.html#reference">Reference:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sml/vreadconnectome.html">Reading data for use in Semi-blind machine learning (SML-EL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sml/vreadconnectome.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vreadconnectome.html#parameters-of-vreadconnectome">Parameters of ‘vreadconnectome’:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sml/vsml_statistics.html">Semi-blind machine learning - ensemble learning (SML-EL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml_statistics.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml_statistics.html#parameters-of-vsml">Parameters of ‘vsml’:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml_statistics.html#reference">Reference:</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Task-related edge density (TED)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ted/vcuttrials.html">Cut functional data into trials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vcuttrials.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vcuttrials.html#parameters-of-vcuttrials">Parameters of ‘vcuttrials’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ted/vted.html">Task-based edge density (TED)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vted.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vted.html#parameters-of-vted">Parameters of ‘vted’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ted/vhubness.html">Hubness maps resulting from TED</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vhubness.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vhubness.html#parameters-of-vhubness">Parameters of ‘vhubness’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ted/vtedfdr.html">False discovery rates in TED</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vtedfdr.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vtedfdr.html#parameters-of-vtedfdr">Parameters of ‘vtedfdr’</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nets/vbcm.html">Bipartite connectivity mapping (BCM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../nets/vbcm.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vbcm.html#parameters-of-vbcm">Parameters of ‘vbcm’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vbcm.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nets/vccm.html">Connectivity concordance mapping (CCM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../nets/vccm.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vccm.html#parameters-of-vccm">Parameters of ‘vccm’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nets/vecm.html">Eigenvector centrality mapping (ECM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../nets/vecm.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vecm.html#parameters-of-vecm">Parameters of ‘vecm’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vecm.html#references">References</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Preprocessing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prep/vdetrend.html">Detrending</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../prep/vdetrend.html#parameters-of-vdetrend">Parameters of ‘vdetrend’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../prep/vpreprocess.html">Spatial smoothing and temporal filtering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../prep/vpreprocess.html#parameters-of-vpreprocess">Parameters of ‘vpreprocess’</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">File format converters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../conv/vdicom.html">Convert from dicom files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../conv/vdicom.html#parameters-of-vdicom">Parameters of ‘vdicom’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../conv/vnifti.html">Convert to/from nifti files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../conv/vnifti.html#parameters-of-vnifti">Parameters of <em>vnifti</em></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/vapplymask.html">Masking an image</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/vapplymask.html#parameters-of-vapplymask">Parameters of ‘vapplymask’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/vdenoise.html">Denoising</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/vsrad.html">Speckle filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="designformat.html">Design file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="designformat_first.html">First level design files</a></li>
<li class="toctree-l1"><a class="reference internal" href="designformat_higher.html">Higher-level  level design files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="designformat_higher.html#one-sample-test">One-sample test</a></li>
<li class="toctree-l2"><a class="reference internal" href="designformat_higher.html#two-sample-test">Two-sample test</a></li>
<li class="toctree-l2"><a class="reference internal" href="designformat_higher.html#paired-test">Paired test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="designformat_higher.html#anova-interactions-and-main-effects-repeated-measures">ANOVA (interactions and main effects, repeated measures)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lipsia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">LISA single subject analysis using precoloring (vlisa_precoloring)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/stats/vlisa_precoloring.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lisa-single-subject-analysis-using-precoloring-vlisa-precoloring">
<h1>LISA single subject analysis using precoloring (vlisa_precoloring)<a class="headerlink" href="#lisa-single-subject-analysis-using-precoloring-vlisa-precoloring" title="Link to this heading"></a></h1>
<p>The program <strong>vlisa_precoloring</strong> performs a single-subject analysis
including a correction for multiple comparisons using the LISA algorithm <a class="reference internal" href="vlisa_twosample.html#lohmann" id="id1"><span>[2018_Lohmann]</span></a>.
The program expects one or more preprocessed 4D fMRI files as input.
The preprocessing pipeline must include a correction for baseline drifts.
The files typically represent runs of an experiment acquired within the same session.</p>
<p>The output is a map thresholded such that FDR &lt; alpha for every voxel.
The default is alpha=0.05.
The resulting image shows (1-FDR) so that larger values indicate higher significance.</p>
<p>Temporal autocorrelations are accounted for using the precoloring approach <a class="reference internal" href="#worsley" id="id2"><span>[1995_Worsley]</span></a>.</p>
<p>Design files in txt-format are also required as input. The number of design files must match the number of runs.
The design files should not include any hemodynamic modelling.
The design file is a txt-file containing one row per trial. Each row must have four values.
The format of each row is: label, onset in seconds, duration in seconds, amplitude.
The labels are integers starting from 1, and represent the label (event type) of that trial.
For example, if there are three different event types, then their labels should be one of 1,2,3.
For a detailed description see  <a class="reference external" href="designformat_first.rst">designformat_first</a>.</p>
<p>The user must also supply a contrast vector whose dimension matches that of the design files.</p>
<p>Hemodynamic modelling is specified using the parameter ‘-hemo’.
Possible values are “gamma_0” (canonical function), “gamma_1” (canonical function plus its first derivative),
“gamma_2” (canonical function plus its first and second derivatives), or “gauss” (Gaussian function).</p>
<p>The option ‘-col1’ determines whether the hemodynamic modelling procedure should add a
a first (leftmost) column of the design file containing the constant value ‘1’.
This column represents a global offset. If set to ‘true’ (default)
then the contrast vector must contain an additional first entry which is usually set to ‘0’.</p>
<p>A txt-file containing additional covariates (e.g. motion parameters) may be added as a separate file.
It must have one line per time volume and one column per covariate.
The covariates are not subjected to any form of hemodynamic modelling,
and are exempt from random permutations.
The nuisance regressors are not included in the contrast vector.
Nuisance files from several runs must be concatenated into one single file. The number of lines in this file must match
the total number of volumes of all runs.
By default, the mean of each regressor is subtracted (‘-demean true’).</p>
<p>The optional parameter ‘-minval’ can be used to specify a threshold that separates brain from non-brain
voxels (brain mask). Voxels whose values in the first volume are below this threshold are discarded from
further analysis. If no value is given, then a heuristic is used to set this threshold automatically.</p>
<p>Optionally, the design file can be obtained as a txt-file using the option ‘-plot’.
The txt-file that will be output using this option contains one column for each regressor.
The task regressors are convolved with a hemodynamic model, the nuisance covariates are normalized.
The file can be visualized using various plotting tools (e.g. vdesignplot or gnuplot).</p>
<p>Note that a region-of-interest mask is required. The mask should exclude non-brain voxels,
and it may cover the entire brain. In the example below, the mask is in the file “braimmask.nii”.</p>
<p><strong>Caution:</strong>
The preprocessing pipeline must include a correction for baseline drifts.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vlisa_precoloring</span> <span class="o">-</span><span class="ow">in</span> <span class="n">run_</span><span class="o">*.</span><span class="n">v</span> <span class="o">-</span><span class="n">design</span> <span class="n">des_</span><span class="o">*.</span><span class="n">txt</span> <span class="o">-</span><span class="n">contrast</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="n">mask</span> <span class="n">brainmask</span><span class="o">.</span><span class="n">nii</span> <span class="o">-</span><span class="n">out</span> <span class="n">result</span><span class="o">.</span><span class="n">v</span> <span class="o">-</span><span class="n">plotdesign</span> <span class="n">X</span><span class="o">.</span><span class="n">txt</span>
<span class="n">vdesignplot</span> <span class="o">-</span><span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Sometimes, it may be useful to obtain an output image that is not FDR-thresholded at a pre-defined alpha level.
This can be achieved by setting the alpha-parameter to 1, i.e. ‘-alpha 1.0’.
The resulting image can later be thresholded using the program “vlisa_applythreshold”. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vlisa_precoloring</span> <span class="o">-</span><span class="ow">in</span> <span class="n">run_</span><span class="o">*.</span><span class="n">v</span> <span class="o">-</span><span class="n">design</span> <span class="n">des_</span><span class="o">*.</span><span class="n">txt</span> <span class="o">-</span><span class="n">contrast</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="n">out</span> <span class="n">result</span><span class="o">.</span><span class="n">v</span> <span class="o">-</span><span class="n">alpha</span> <span class="mf">1.0</span>
<span class="n">vlisa_applythreshold</span> <span class="o">-</span><span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">v</span> <span class="o">-</span><span class="n">out</span> <span class="n">thresholded</span><span class="o">.</span><span class="n">v</span> <span class="o">-</span><span class="n">threshold</span> <span class="mf">0.05</span>
</pre></div>
</div>
<p>Note that this program also accepts input images in Nifti format (“run_*.nii” or “run_*.nii.gz”),
but the output is always in vista format.
To convert the output to the Nifti format, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vnifti</span> <span class="o">-</span><span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">v</span> <span class="o">-</span><span class="n">out</span> <span class="n">result</span><span class="o">.</span><span class="n">nii</span>
</pre></div>
</div>
<section id="parameters-of-vlisa-precoloring">
<h2>Parameters of ‘vlisa_precoloring’:<a class="headerlink" href="#parameters-of-vlisa-precoloring" title="Link to this heading"></a></h2>
<blockquote>
<div><dl class="option-list">
<dt><kbd><span class="option">-h<var>elp</var></span></kbd></dt>
<dd><p>Prints usage information.</p>
</dd>
<dt><kbd><span class="option">-i<var>n</var></span></kbd></dt>
<dd><p>Input file(s).</p>
</dd>
<dt><kbd><span class="option">-o<var>ut</var></span></kbd></dt>
<dd><p>Output file.</p>
</dd>
<dt><kbd><span class="option">-d<var>esign</var></span></kbd></dt>
<dd><p>Design files.</p>
</dd>
<dt><kbd><span class="option">-c<var>ontrast</var></span></kbd></dt>
<dd><p>Contrast vector.</p>
</dd>
<dt><kbd><span class="option">-n<var>uisance</var></span></kbd></dt>
<dd><p>Nuisance regressors (optional).</p>
</dd>
<dt><kbd><span class="option">-d<var>emean</var></span></kbd></dt>
<dd><p>Whether to subtract mean in nuisance regressors. Default: true</p>
</dd>
<dt><kbd><span class="option">-h<var>emo</var></span></kbd></dt>
<dd><p>Hemodynamic model [ gamma_0 | gamma_1 | gamma_2 | gauss ]. Default: gamma_0</p>
</dd>
<dt><kbd><span class="option">-c<var>ol1</var></span></kbd></dt>
<dd><p>Whether to add a constant first column. Default: true</p>
</dd>
<dt><kbd><span class="option">-a<var>lpha</var></span></kbd></dt>
<dd><p>FDR significance level. Default: 0.05</p>
</dd>
<dt><kbd><span class="option">-p<var>erm</var></span></kbd></dt>
<dd><p>Number of permutations. Default: 5000</p>
</dd>
<dt><kbd><span class="option">-m<var>ask</var></span></kbd></dt>
<dd><p>Region of interest mask.</p>
</dd>
<dt><kbd><span class="option">-m<var>inval</var></span></kbd></dt>
<dd><p>Signal threshold.</p>
</dd>
<dt><kbd><span class="option">-s<var>eed</var></span></kbd></dt>
<dd><p>Seed for random number generation. Default: 99402622</p>
</dd>
<dt><kbd><span class="option">-p<var>lotdesign</var></span></kbd></dt>
<dd><p>Filename for plotting design matrix X (optional).</p>
</dd>
<dt><kbd><span class="option">-r<var>adius</var></span></kbd></dt>
<dd><p>Bilateral parameter (radius in voxels). Default: 2</p>
</dd>
<dt><kbd><span class="option">-r<var>var</var></span></kbd></dt>
<dd><p>Bilateral parameter (radiometric). Default: 2.0</p>
</dd>
<dt><kbd><span class="option">-s<var>var</var></span></kbd></dt>
<dd><p>Bilateral parameter (spatial). Default: 2</p>
</dd>
<dt><kbd><span class="option">-f<var>ilteriterations</var></span></kbd></dt>
<dd><p>Bilateral parameter (number of iterations). Default: 2</p>
</dd>
<dt><kbd><span class="option">-c<var>leanup</var></span></kbd></dt>
<dd><p>Whether to delete isolated voxels. Default: true</p>
</dd>
<dt><kbd><span class="option">-j</span></kbd></dt>
<dd><p>Number of processors to use, ‘0’ to use all. Default: 0</p>
</dd>
</dl>
</div></blockquote>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading"></a></h3>
<div role="list" class="citation-list">
<div class="citation" id="worsley" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1995_Worsley</a><span class="fn-bracket">]</span></span>
<p>Worsley, K.J. et al (1995). Analysis of fMRI time-series revisited - again. <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/9343600">(link)</a></p>
</div>
<div class="citation" id="lohmann" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">2018_Lohmann</a><span class="fn-bracket">]</span></span>
<p>Lohmann G., Stelzer J., Lacosse E., Kumar V.J., Mueller K., Kuehn E., Grodd W., Scheffler K. (2018). LISA improves statistical analysis for fMRI. Nature Communications 9:4014. <a class="reference external" href="https://www.nature.com/articles/s41467-018-06304-z">(link)</a></p>
</div>
</div>
<span class="target" id="index-0"></span></section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vlisa_twosample.html" class="btn btn-neutral float-left" title="LISA twosample test (vlisa_twosample)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vlisa_prewhitening.html" class="btn btn-neutral float-right" title="LISA single subject analysis using prewhitening (vlisa_prewhitening)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Gabriele Lohmann.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>