

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Higher-level level design files &mdash; lipsia  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="First level design files" href="designformat_first.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            lipsia
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#lipsia-file-format">Lipsia file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#laminar-specific-fmri-analysis-cylarim-under-construction">Laminar-specific fMRI analysis (Cylarim) - under construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#statistical-inference-lisa-in-examples">Statistical inference (LISA) in examples:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#semi-blind-machine-learning-sml">Semi-blind machine learning (SML):</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#how-to-install-lipsia-using-singularity">How to install LIPSIA using Singularity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#install-lipsia-from-source-linux-unix-macos">Install LIPSIA from source (Linux/Unix/MacOS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#install-the-necessary-compilers-and-libraries">1) Install the necessary compilers and libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#ubuntu">Ubuntu:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#fedora">Fedora:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#macos">MacOS:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#clone-the-git-repository">2) Clone the git repository:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#execute-the-script-lipsia-setup-sh-in-a-shell">3) Execute the script “lipsia-setup.sh” (in a shell)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#compile-lipsia">4) Compile lipsia</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#change-bash-profile">5) Change bash profile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#install-lipsia-using-docker">Install LIPSIA using Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#install-docker-on-your-local-machine">1) Install docker on your local machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#build-the-dockerfile">3) Build the Dockerfile</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Laminar-specific fMRI (Cylarim)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/index.html">Cylarim overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#initial-steps">Initial steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#the-main-steps">The main steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#example-workflow">Example workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/index.html#contents">Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim.html">vcylarim</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim.html#parameters-of-vcylarim">Parameters of ‘vcylarim’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim_stats.html">vcylarim_stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_stats.html#examples">Examples:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_stats.html#parameters-of-vcylarim-stats">Parameters of ‘vcylarim_stats’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim_getmask.html">vcylarim_getmask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#parameters-of-vcylarim-getmask">Parameters of ‘vcylarim_getmask’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vcylarim_plot.html">vcylarim_plot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example-output">Example output:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vcylarim_plot.html#parameters-of-vcylarim-plot">Parameters of ‘vcylarim_plot’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vrim.html">vrim</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vrim.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vrim.html#parameters-of-vrim">Parameters of ‘vrim’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cylarim/vmetric.html">vmetric</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vmetric.html#example">Example:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cylarim/vmetric.html#parameters-of-vmetric">Parameters of ‘vmetric’</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim.html">vcylarim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim.html#parameters-of-vcylarim">Parameters of ‘vcylarim’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim_stats.html">vcylarim_stats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_stats.html#examples">Examples:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_stats.html#parameters-of-vcylarim-stats">Parameters of ‘vcylarim_stats’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim_plot.html">vcylarim_plot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_plot.html#example-output">Example output:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_plot.html#parameters-of-vcylarim-plot">Parameters of ‘vcylarim_plot’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vcylarim_getmask.html">vcylarim_getmask</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vcylarim_getmask.html#parameters-of-vcylarim-getmask">Parameters of ‘vcylarim_getmask’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vmetric.html">vmetric</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vmetric.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vmetric.html#parameters-of-vmetric">Parameters of ‘vmetric’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cylarim/vrim.html">vrim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vrim.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cylarim/vrim.html#parameters-of-vrim">Parameters of ‘vrim’</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LISA statistical inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="vlisa_generic.html">LISA generic framework (vlisa_generic)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_generic.html#parameters-of-vlisa-generic">Parameters of ‘vlisa_generic’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_generic.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_2ndlevel.html">LISA second-level GLM (vlisa_2ndlevel)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_2ndlevel.html#parameters-of-vlisa-2ndlevel">Parameters of ‘vlisa_2ndlevel’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_2ndlevel.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_onesample.html">LISA onesample test (vlisa_onesample)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_onesample.html#parameters-of-vlisa-onesample">Parameters of ‘vlisa_onesample’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_onesample.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_twosample.html">LISA twosample test (vlisa_twosample)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_twosample.html#parameters-of-vlisa-twosample">Parameters of ‘vlisa_twosample’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_twosample.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_precoloring.html">LISA single subject analysis using precoloring (vlisa_precoloring)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_precoloring.html#parameters-of-vlisa-precoloring">Parameters of ‘vlisa_precoloring’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_precoloring.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vlisa_prewhitening.html">LISA single subject analysis using prewhitening (vlisa_prewhitening)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vlisa_prewhitening.html#parameters-of-vlisa-prewhitening">Parameters of ‘vlisa_prewhitening’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vlisa_prewhitening.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Semi-blind machine learning (SML):</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sml/vsml.html">Semi-blind machine learning - ensemble learning (SML-EL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml.html#parameters-of-vsml">Parameters of ‘vsml’:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sml/vsml.html#reference">Reference:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sml/vreadconnectome.html">Reading data for use in Semi-blind machine learning (SML-EL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sml/vreadconnectome.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vreadconnectome.html#parameters-of-vreadconnectome">Parameters of ‘vreadconnectome’:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sml/vsml_statistics.html">Semi-blind machine learning - ensemble learning (SML-EL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml_statistics.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml_statistics.html#parameters-of-vsml">Parameters of ‘vsml’:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sml/vsml_statistics.html#reference">Reference:</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Task-related edge density (TED)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ted/vcuttrials.html">Cut functional data into trials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vcuttrials.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vcuttrials.html#parameters-of-vcuttrials">Parameters of ‘vcuttrials’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ted/vted.html">Task-based edge density (TED)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vted.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vted.html#parameters-of-vted">Parameters of ‘vted’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ted/vhubness.html">Hubness maps resulting from TED</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vhubness.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vhubness.html#parameters-of-vhubness">Parameters of ‘vhubness’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ted/vtedfdr.html">False discovery rates in TED</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ted/vtedfdr.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ted/vtedfdr.html#parameters-of-vtedfdr">Parameters of ‘vtedfdr’</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nets/vbcm.html">Bipartite connectivity mapping (BCM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../nets/vbcm.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vbcm.html#parameters-of-vbcm">Parameters of ‘vbcm’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vbcm.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nets/vccm.html">Connectivity concordance mapping (CCM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../nets/vccm.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vccm.html#parameters-of-vccm">Parameters of ‘vccm’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nets/vecm.html">Eigenvector centrality mapping (ECM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../nets/vecm.html#example">Example:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vecm.html#parameters-of-vecm">Parameters of ‘vecm’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nets/vecm.html#references">References</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Preprocessing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../prep/vdetrend.html">Detrending</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../prep/vdetrend.html#parameters-of-vdetrend">Parameters of ‘vdetrend’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../prep/vpreprocess.html">Spatial smoothing and temporal filtering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../prep/vpreprocess.html#parameters-of-vpreprocess">Parameters of ‘vpreprocess’</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">File format converters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../conv/vdicom.html">Convert from dicom files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../conv/vdicom.html#parameters-of-vdicom">Parameters of ‘vdicom’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../conv/vnifti.html">Convert to/from nifti files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../conv/vnifti.html#parameters-of-vnifti">Parameters of <em>vnifti</em></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../utils/vapplymask.html">Masking an image</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/vapplymask.html#parameters-of-vapplymask">Parameters of ‘vapplymask’</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/vdenoise.html">Denoising</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/vsrad.html">Speckle filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="designformat.html">Design file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="designformat_first.html">First level design files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Higher-level  level design files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#one-sample-test">One-sample test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#two-sample-test">Two-sample test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#paired-test">Paired test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#anova-interactions-and-main-effects-repeated-measures">ANOVA (interactions and main effects, repeated measures)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lipsia</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Higher-level  level design files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/stats/designformat_higher.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="higher-level-level-design-files">
<h1>Higher-level  level design files<a class="headerlink" href="#higher-level-level-design-files" title="Link to this heading"></a></h1>
<p>Higher-level designs are used to compute higher-level statistics such as two-sample or paired tests
so that groups of data sets can be statistically assessed.</p>
<p>For a higher level analysis,
a design file has to be created that can be used in ‘vlisa_2ndlevel’.
For all higher level design files, the <em>number of rows</em> must coincide
with the number of input files to ‘vlisa_2ndlevel’.</p>
<p>Note that convenience programs exist that can be used instead of the more complicated way of
specifying high-level statistics via ‘vlisa_2ndlevel’. These programs are:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="vlisa_onesample.rst">vlisa_onesample</a></p></li>
<li><p><a class="reference external" href="vlisa_twosample.rst">vlisa_twosample</a></p></li>
</ul>
</div></blockquote>
<p>However, higher-level design files are needed in more complex situations.
Below, some simple design files are listed for tutorial purposes.</p>
<section id="one-sample-test">
<h2>One-sample test<a class="headerlink" href="#one-sample-test" title="Link to this heading"></a></h2>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span>
<span class="o">%</span> <span class="n">second</span> <span class="n">level</span> <span class="n">design</span> <span class="n">file</span><span class="p">,</span> <span class="n">one</span><span class="o">-</span><span class="n">sample</span> <span class="n">test</span>
<span class="o">%</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<p>This example design can be used to perform a one-sample test for 8 scans.
Each row in this file corresponds to one scan.
The contrast vector in this case is ‘1’ (to test for &gt; 0) or ‘-1’ (to test for &lt; 0).
For such simple scenarios, an easier way to do a one-sample test is to use <a class="reference external" href="vlisa_onesample.rst">vlisa_onesample</a>.</p>
</section>
<section id="two-sample-test">
<h2>Two-sample test<a class="headerlink" href="#two-sample-test" title="Link to this heading"></a></h2>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span>
<span class="o">%</span> <span class="n">second</span> <span class="n">level</span> <span class="n">design</span> <span class="n">file</span><span class="p">,</span> <span class="n">two</span><span class="o">-</span><span class="n">sample</span> <span class="n">test</span>
<span class="o">%</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<p>This example design can be used to perform a two-sample test
for comparing two groups of 8 subjects each (e.g. patients vs. healthy controls). The contrast vector comparing the two groups should be ‘1 -1’
(to test for patient &gt; control) or ‘-1 1’ (to test for patient &lt; control).
<strong>Important</strong>: the order of the scans in this example is expected to be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">patient</span> <span class="mi">1</span>
<span class="n">patient</span> <span class="mi">2</span>
<span class="n">patient</span> <span class="mi">3</span>
<span class="n">patient</span> <span class="mi">4</span>
<span class="n">patient</span> <span class="mi">5</span>
<span class="n">patient</span> <span class="mi">6</span>
<span class="n">patient</span> <span class="mi">7</span>
<span class="n">patient</span> <span class="mi">8</span>
<span class="n">control</span> <span class="mi">1</span>
<span class="n">control</span> <span class="mi">2</span>
<span class="n">control</span> <span class="mi">3</span>
<span class="n">control</span> <span class="mi">4</span>
<span class="n">control</span> <span class="mi">5</span>
<span class="n">control</span> <span class="mi">6</span>
<span class="n">control</span> <span class="mi">7</span>
<span class="n">control</span> <span class="mi">8</span>
</pre></div>
</div>
<p>For such simple scenarios, an easier way to the same test is to use  <a class="reference external" href="vlisa_twosample.rst">vlisa_twosample</a>.</p>
</section>
<section id="paired-test">
<h2>Paired test<a class="headerlink" href="#paired-test" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span>
<span class="o">%</span> <span class="n">second</span> <span class="n">level</span> <span class="n">design</span> <span class="n">file</span><span class="p">,</span> <span class="n">paired</span> <span class="n">test</span>
<span class="o">%</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This example design file can be used to perform a paired test. Here it specifies 8 subjects which have been scanned twice (e.g. the same subject scanned in the morning vs. scanned in the afternoon).
The design file much resembles the one from above for the twosample test. However, there are eight additional columns (one for each subject).
A value of “1” in these columns indicates that this scan belongs to the subject’s column. In our example, the third column indicates the first subject (the two columns before indicate the experimental condition, as in the twosample test). Only the first and second scan (row in the design matrix) have a “1” here. This way of writing the design matrix is equivalent to a paired twosample test, as the additional subject-wise regressors take out what is commonly found in both scans of the same subject. Having more columns in the design matrix means that the contrast vector is longer (it should always correspond to the number of columns).
Furthermore, as we don’t want to constrain the permutations within one subject (avoiding mixing of within- and across subjects), we need to supply the permutation group IDs with the <strong>-grp</strong> argument. We supply a text file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="mi">7</span>
<span class="mi">8</span>
<span class="mi">8</span>
</pre></div>
</div>
<p>To estimate the effect, we could use as contrast vector ‘1 -1 0 0 0 0 0 0 0 0’ (indicating morning &gt; afternoon).
An easier way to do a paired test is to use  <strong>vlisa_twosample -test paired</strong>.</p>
<p><strong>Important</strong>: the order of the scans in this example is expected to be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">morning</span> <span class="n">subj</span> <span class="mi">1</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">1</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">2</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">2</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">3</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">3</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">4</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">4</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">5</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">5</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">6</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">6</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">7</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">7</span>
<span class="n">morning</span> <span class="n">subj</span> <span class="mi">8</span>
<span class="n">afternoon</span> <span class="n">subj</span> <span class="mi">8</span>
</pre></div>
</div>
</section>
</section>
<section id="anova-interactions-and-main-effects-repeated-measures">
<h1>ANOVA (interactions and main effects, repeated measures)<a class="headerlink" href="#anova-interactions-and-main-effects-repeated-measures" title="Link to this heading"></a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span>
<span class="o">%</span> <span class="n">second</span> <span class="n">level</span> <span class="n">design</span> <span class="n">file</span><span class="p">,</span> <span class="n">ANOVA</span>
<span class="o">%</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This example design can be used to compute an ANOVA (2x2, repeated measures). Here, we have two groups of subjects, with 4 subjects per group (hence, we have 2*2*4=16 scans = a design file with 16 rows). For instance, we have 4 control subjects scanned in the morning and afternoon, furthermore we have 4 patients scanned in the morning and afternoon (each subject was scanned twice, this is a repeated measures design).
Similar to the design file above for the paired test, we have two types of columns in the design matrix: the first four columns indicate the experimental condition for each of the two groups separately (morning control, afternoon control, morning patient, afternoon patient), the next 8 columns indicate the subject (there were 2*4 subjects). As with the paired test, this design effectively models  what is commonly found in both scans for any given subject.
Specifying the type of test (interaction or main effect) is done via the contrast vector (which has the same length as the number of columns in the design).
To study the interaction (morning control - afternoon control) - (morning patients - afternoon patients), i.e. which brain areas show a larger change morning minus afternoon or the controls, use this contrast vector: ‘1 -1 -1 1 0 0 0 0 0 0 0 0’. Note the signs of the third and fourth element (they differ from the first and second), as we are computing a difference of differences. To test for the main effect morning - afternoon, we specify the contrast vector: ‘1 -1 1 -1 0 0 0 0 0 0 0 0’.
The design files can either be generated using the tool <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/GLM">GLM</a> of the FSL software package, or via manual specification.</p>
<p>Furthermore, as we don’t want to constrain the permutations within one subject (avoiding mixing of within- and across subjects), we need to supply the permutation group IDs with the <strong>-grp</strong> argument. We supply a text file with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="mi">7</span>
<span class="mi">8</span>
<span class="mi">8</span>
</pre></div>
</div>
<p><strong>Important</strong>: the order of the scans in this example is expected to be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">morning</span> <span class="n">control</span> <span class="mi">1</span>
<span class="n">afternoon</span> <span class="n">control</span> <span class="mi">1</span>
<span class="n">morning</span> <span class="n">control</span> <span class="mi">2</span>
<span class="n">afternoon</span> <span class="n">control</span> <span class="mi">2</span>
<span class="n">morning</span> <span class="n">control</span> <span class="mi">3</span>
<span class="n">afternoon</span> <span class="n">control</span> <span class="mi">3</span>
<span class="n">morning</span> <span class="n">control</span> <span class="mi">4</span>
<span class="n">afternoon</span> <span class="n">control</span> <span class="mi">4</span>
<span class="n">morning</span> <span class="n">patient</span> <span class="mi">1</span>
<span class="n">afternoon</span> <span class="n">patient</span> <span class="mi">1</span>
<span class="n">morning</span> <span class="n">patient</span> <span class="mi">2</span>
<span class="n">afternoon</span> <span class="n">patient</span> <span class="mi">2</span>
<span class="n">morning</span> <span class="n">patient</span> <span class="mi">3</span>
<span class="n">afternoon</span> <span class="n">patient</span> <span class="mi">3</span>
<span class="n">morning</span> <span class="n">patient</span> <span class="mi">4</span>
<span class="n">afternoon</span> <span class="n">patient</span> <span class="mi">4</span>
</pre></div>
</div>
<span class="target" id="index-0"></span></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="designformat_first.html" class="btn btn-neutral float-left" title="First level design files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Gabriele Lohmann.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>